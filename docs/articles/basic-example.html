<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Basic example of history matching with emulation workflow • hmsandwich</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Basic example of history matching with emulation workflow">
<meta property="og:description" content="hmsandwich">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">hmsandwich</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/basic-example.html">Basic example of history matching with emulation workflow</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Basic example of history matching with emulation
workflow</h1>
            
      
      
      <div class="hidden name"><code>basic-example.Rmd</code></div>

    </div>

    
    
<p>Packages used in this vignette.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">hmsandwich</span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="sir-model">SIR model<a class="anchor" aria-label="anchor" href="#sir-model"></a>
</h2>
<p>We’ll use the simple susceptible-infected-removed model used in the
<a href="https://github.com/andy-iskauskas/hmer" class="external-link">hmer</a> package examples.</p>
<p>Our package used tidy models for inspiration <a href="https://www.tmwr.org/workflows.html" class="external-link"></a>.</p>
</div>
<div class="section level2">
<h2 id="input-data">Input data<a class="anchor" aria-label="anchor" href="#input-data"></a>
</h2>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ranges</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  b <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1e-5</span>, <span class="fl">1e-4</span><span class="op">)</span>,       <span class="co"># birth rate</span></span>
<span>  mu <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1e-5</span>, <span class="fl">1e-4</span><span class="op">)</span>,      <span class="co"># rate of death from other causes</span></span>
<span>  beta1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.2</span>, <span class="fl">0.3</span><span class="op">)</span>,     <span class="co"># infection rate at time t=0</span></span>
<span>  beta2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">0.2</span><span class="op">)</span>,     <span class="co"># infection rates at time t=100</span></span>
<span>  beta3 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.3</span>, <span class="fl">0.5</span><span class="op">)</span>,     <span class="co"># infection rates at time t=270</span></span>
<span>  epsilon <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.07</span>, <span class="fl">0.21</span><span class="op">)</span>, <span class="co"># rate of becoming infectious after infection</span></span>
<span>  alpha <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.01</span>, <span class="fl">0.025</span><span class="op">)</span>,  <span class="co"># rate of death from the disease</span></span>
<span>  gamma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.05</span>, <span class="fl">0.08</span><span class="op">)</span>,   <span class="co"># recovery rate</span></span>
<span>  omega <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.002</span>, <span class="fl">0.004</span><span class="op">)</span>  <span class="co"># rate at which immunity is lost following recovery</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">targets</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  I25 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>val <span class="op">=</span> <span class="fl">115.88</span>, sigma <span class="op">=</span> <span class="fl">5.79</span><span class="op">)</span>,</span>
<span>  I40 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>val <span class="op">=</span> <span class="fl">137.84</span>, sigma <span class="op">=</span> <span class="fl">6.89</span><span class="op">)</span>,</span>
<span>  I100 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>val <span class="op">=</span> <span class="fl">26.34</span>, sigma <span class="op">=</span> <span class="fl">1.317</span><span class="op">)</span>,</span>
<span>  I200 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>val <span class="op">=</span> <span class="fl">0.68</span>, sigma <span class="op">=</span> <span class="fl">0.034</span><span class="op">)</span>,</span>
<span>  I300 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>val <span class="op">=</span> <span class="fl">29.55</span>, sigma <span class="op">=</span> <span class="fl">1.48</span><span class="op">)</span>,</span>
<span>  I350 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>val <span class="op">=</span> <span class="fl">68.89</span>, sigma <span class="op">=</span> <span class="fl">3.44</span><span class="op">)</span>,</span>
<span>  R25 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>val <span class="op">=</span> <span class="fl">125.12</span>, sigma <span class="op">=</span> <span class="fl">6.26</span><span class="op">)</span>,</span>
<span>  R40 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>val <span class="op">=</span> <span class="fl">256.80</span>, sigma <span class="op">=</span> <span class="fl">12.84</span><span class="op">)</span>,</span>
<span>  R100 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>val <span class="op">=</span> <span class="fl">538.99</span>, sigma <span class="op">=</span> <span class="fl">26.95</span><span class="op">)</span>,</span>
<span>  R200 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>val <span class="op">=</span> <span class="fl">444.23</span>, sigma <span class="op">=</span> <span class="fl">22.21</span><span class="op">)</span>,</span>
<span>  R300 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>val <span class="op">=</span> <span class="fl">371.08</span>, sigma <span class="op">=</span> <span class="fl">15.85</span><span class="op">)</span>,</span>
<span>  R350 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>val <span class="op">=</span> <span class="fl">549.42</span>, sigma <span class="op">=</span> <span class="fl">27.47</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="sir-model-functions">SIR model functions<a class="anchor" aria-label="anchor" href="#sir-model-functions"></a>
</h2>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># provides the solution of the differential equations for a given </span></span>
<span><span class="co"># set of parameters. assumes an initial population of </span></span>
<span><span class="co"># 900 susceptible individuals, 100 exposed individuals, and no infectious </span></span>
<span><span class="co"># or recovered individuals.</span></span>
<span><span class="va">ode_results</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">parms</span>, <span class="va">end_time</span> <span class="op">=</span> <span class="fl">365</span><span class="op">*</span><span class="fl">2</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">forcer</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,   <span class="va">parms</span><span class="op">[</span><span class="st">'beta1'</span><span class="op">]</span>,</span>
<span>                    <span class="fl">100</span>, <span class="va">parms</span><span class="op">[</span><span class="st">'beta2'</span><span class="op">]</span>,</span>
<span>                    <span class="fl">180</span>, <span class="va">parms</span><span class="op">[</span><span class="st">'beta2'</span><span class="op">]</span>,</span>
<span>                    <span class="fl">270</span>, <span class="va">parms</span><span class="op">[</span><span class="st">'beta3'</span><span class="op">]</span><span class="op">)</span>,</span>
<span>                  ncol <span class="op">=</span> <span class="fl">2</span>,</span>
<span>                  byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>  <span class="va">force_func</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/approxfun.html" class="external-link">approxfun</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="va">forcer</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span>,</span>
<span>    y <span class="op">=</span> <span class="va">forcer</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span>,</span>
<span>    method <span class="op">=</span> <span class="st">"linear"</span>,</span>
<span>    rule <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">des</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">time</span>, <span class="va">state</span>, <span class="va">parms</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">as.list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">state</span>, <span class="va">parms</span><span class="op">)</span><span class="op">)</span>, <span class="op">{</span></span>
<span>      <span class="co"># N &lt;- S + E + I + R</span></span>
<span>      <span class="va">dS</span> <span class="op">&lt;-</span> <span class="va">b</span><span class="op">*</span><span class="op">(</span><span class="va">S</span><span class="op">+</span><span class="va">E</span><span class="op">+</span><span class="va">I</span><span class="op">+</span><span class="va">R</span><span class="op">)</span> <span class="op">-</span> <span class="fu">force_func</span><span class="op">(</span><span class="va">time</span><span class="op">)</span><span class="op">*</span><span class="va">I</span><span class="op">*</span><span class="va">S</span> <span class="op">/</span> <span class="op">(</span><span class="va">S</span><span class="op">+</span><span class="va">E</span><span class="op">+</span><span class="va">I</span><span class="op">+</span><span class="va">R</span><span class="op">)</span> <span class="op">+</span> <span class="va">omega</span><span class="op">*</span><span class="va">R</span> <span class="op">-</span> <span class="va">mu</span><span class="op">*</span><span class="va">S</span></span>
<span>      <span class="va">dE</span> <span class="op">&lt;-</span> <span class="fu">force_func</span><span class="op">(</span><span class="va">time</span><span class="op">)</span><span class="op">*</span><span class="va">I</span><span class="op">*</span><span class="va">S</span> <span class="op">/</span> <span class="op">(</span><span class="va">S</span><span class="op">+</span><span class="va">E</span><span class="op">+</span><span class="va">I</span><span class="op">+</span><span class="va">R</span><span class="op">)</span> <span class="op">-</span> <span class="va">epsilon</span><span class="op">*</span><span class="va">E</span> <span class="op">-</span> <span class="va">mu</span><span class="op">*</span><span class="va">E</span></span>
<span>      <span class="va">dI</span> <span class="op">&lt;-</span> <span class="va">epsilon</span><span class="op">*</span><span class="va">E</span> <span class="op">-</span> <span class="va">alpha</span><span class="op">*</span><span class="va">I</span> <span class="op">-</span> <span class="va">gamma</span><span class="op">*</span><span class="va">I</span> <span class="op">-</span> <span class="va">mu</span><span class="op">*</span><span class="va">I</span></span>
<span>      <span class="va">dR</span> <span class="op">&lt;-</span> <span class="va">gamma</span><span class="op">*</span><span class="va">I</span> <span class="op">-</span> <span class="va">omega</span><span class="op">*</span><span class="va">R</span> <span class="op">-</span> <span class="va">mu</span><span class="op">*</span><span class="va">R</span></span>
<span>      <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">dS</span>, <span class="va">dE</span>, <span class="va">dI</span>, <span class="va">dR</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="op">}</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="va">yini</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>S <span class="op">=</span> <span class="fl">900</span>, E <span class="op">=</span> <span class="fl">100</span>, I <span class="op">=</span> <span class="fl">0</span>, R <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span>  <span class="va">times</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">end_time</span>, by <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="fu">deSolve</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/deSolve/man/ode.html" class="external-link">ode</a></span><span class="op">(</span><span class="va">yini</span>, <span class="va">times</span>, <span class="va">des</span>, <span class="va">parms</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co">#' Wrapper for `ode_results` to subset which outputs and times should be returned</span></span>
<span><span class="co">#'</span></span>
<span><span class="co">#' For example, to obtain the number of infected and susceptible individuals </span></span>
<span><span class="co">#' at t=25 and t=50</span></span>
<span><span class="co">#' times = c(25,50)</span></span>
<span><span class="co">#' outputs = c('I','S')</span></span>
<span><span class="co">#' @returns</span></span>
<span><span class="co">#'</span></span>
<span><span class="va">sir_model</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">params</span>, <span class="va">times</span>, <span class="va">outputs</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">t_max</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">times</span><span class="op">)</span></span>
<span>  <span class="va">all_res</span> <span class="op">&lt;-</span> <span class="fu">ode_results</span><span class="op">(</span><span class="va">params</span>, <span class="va">t_max</span><span class="op">)</span></span>
<span>  <span class="va">actual_res</span> <span class="op">&lt;-</span> <span class="va">all_res</span><span class="op">[</span><span class="va">all_res</span><span class="op">[</span>,<span class="st">'time'</span><span class="op">]</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">times</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'time'</span>, <span class="va">outputs</span><span class="op">)</span><span class="op">]</span></span>
<span>  <span class="va">shaped</span> <span class="op">&lt;-</span> <span class="fu">reshape2</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/reshape2/man/melt.html" class="external-link">melt</a></span><span class="op">(</span><span class="va">actual_res</span><span class="op">[</span>, <span class="va">outputs</span><span class="op">]</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">names_shaped</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">shaped</span><span class="op">$</span><span class="va">Var2</span>, <span class="va">actual_res</span><span class="op">[</span>,<span class="st">'time'</span><span class="op">]</span>, sep <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span>
<span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/setNames.html" class="external-link">setNames</a></span><span class="op">(</span><span class="va">shaped</span><span class="op">$</span><span class="va">value</span>, <span class="va">names_shaped</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="analysis">Analysis<a class="anchor" aria-label="anchor" href="#analysis"></a>
</h2>
<p>Create analysis object.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sir_hmer</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="../reference/hmer_analysis.html">hmer_analysis</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/add_input_ranges.html">add_input_ranges</a></span><span class="op">(</span><span class="va">ranges</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/add_targets.html">add_targets</a></span><span class="op">(</span><span class="va">targets</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/add_model.html">add_model</a></span><span class="op">(</span><span class="va">sir_model</span><span class="op">)</span></span></code></pre></div>
<p>Run initial wave.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sir_hmer</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/run_wave.html">run_wave</a></span><span class="op">(</span><span class="va">sir_hmer</span><span class="op">)</span></span>
<span><span class="co"># sir_hmer@run_wave</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">sir_hmer</span><span class="op">)</span></span>
<span><span class="co">#&gt; List of 10</span></span>
<span><span class="co">#&gt;  $ wave_no        : num 1</span></span>
<span><span class="co">#&gt;  $ n_train        : num 100</span></span>
<span><span class="co">#&gt;  $ n_grps_in      : NULL</span></span>
<span><span class="co">#&gt;  $ groups_in      : NULL</span></span>
<span><span class="co">#&gt;  $ indx_out       : NULL</span></span>
<span><span class="co">#&gt;  $ full_groups_out: NULL</span></span>
<span><span class="co">#&gt;  $ ranges         :List of 9</span></span>
<span><span class="co">#&gt;   ..$ b      : num [1:2] 1e-05 1e-04</span></span>
<span><span class="co">#&gt;   ..$ mu     : num [1:2] 1e-05 1e-04</span></span>
<span><span class="co">#&gt;   ..$ beta1  : num [1:2] 0.2 0.3</span></span>
<span><span class="co">#&gt;   ..$ beta2  : num [1:2] 0.1 0.2</span></span>
<span><span class="co">#&gt;   ..$ beta3  : num [1:2] 0.3 0.5</span></span>
<span><span class="co">#&gt;   ..$ epsilon: num [1:2] 0.07 0.21</span></span>
<span><span class="co">#&gt;   ..$ alpha  : num [1:2] 0.01 0.025</span></span>
<span><span class="co">#&gt;   ..$ gamma  : num [1:2] 0.05 0.08</span></span>
<span><span class="co">#&gt;   ..$ omega  : num [1:2] 0.002 0.004</span></span>
<span><span class="co">#&gt;  $ targets        :List of 12</span></span>
<span><span class="co">#&gt;   ..$ I25 :List of 2</span></span>
<span><span class="co">#&gt;   .. ..$ val  : num 116</span></span>
<span><span class="co">#&gt;   .. ..$ sigma: num 5.79</span></span>
<span><span class="co">#&gt;   ..$ I40 :List of 2</span></span>
<span><span class="co">#&gt;   .. ..$ val  : num 138</span></span>
<span><span class="co">#&gt;   .. ..$ sigma: num 6.89</span></span>
<span><span class="co">#&gt;   ..$ I100:List of 2</span></span>
<span><span class="co">#&gt;   .. ..$ val  : num 26.3</span></span>
<span><span class="co">#&gt;   .. ..$ sigma: num 1.32</span></span>
<span><span class="co">#&gt;   ..$ I200:List of 2</span></span>
<span><span class="co">#&gt;   .. ..$ val  : num 0.68</span></span>
<span><span class="co">#&gt;   .. ..$ sigma: num 0.034</span></span>
<span><span class="co">#&gt;   ..$ I300:List of 2</span></span>
<span><span class="co">#&gt;   .. ..$ val  : num 29.6</span></span>
<span><span class="co">#&gt;   .. ..$ sigma: num 1.48</span></span>
<span><span class="co">#&gt;   ..$ I350:List of 2</span></span>
<span><span class="co">#&gt;   .. ..$ val  : num 68.9</span></span>
<span><span class="co">#&gt;   .. ..$ sigma: num 3.44</span></span>
<span><span class="co">#&gt;   ..$ R25 :List of 2</span></span>
<span><span class="co">#&gt;   .. ..$ val  : num 125</span></span>
<span><span class="co">#&gt;   .. ..$ sigma: num 6.26</span></span>
<span><span class="co">#&gt;   ..$ R40 :List of 2</span></span>
<span><span class="co">#&gt;   .. ..$ val  : num 257</span></span>
<span><span class="co">#&gt;   .. ..$ sigma: num 12.8</span></span>
<span><span class="co">#&gt;   ..$ R100:List of 2</span></span>
<span><span class="co">#&gt;   .. ..$ val  : num 539</span></span>
<span><span class="co">#&gt;   .. ..$ sigma: num 26.9</span></span>
<span><span class="co">#&gt;   ..$ R200:List of 2</span></span>
<span><span class="co">#&gt;   .. ..$ val  : num 444</span></span>
<span><span class="co">#&gt;   .. ..$ sigma: num 22.2</span></span>
<span><span class="co">#&gt;   ..$ R300:List of 2</span></span>
<span><span class="co">#&gt;   .. ..$ val  : num 371</span></span>
<span><span class="co">#&gt;   .. ..$ sigma: num 15.8</span></span>
<span><span class="co">#&gt;   ..$ R350:List of 2</span></span>
<span><span class="co">#&gt;   .. ..$ val  : num 549</span></span>
<span><span class="co">#&gt;   .. ..$ sigma: num 27.5</span></span>
<span><span class="co">#&gt;  $ model          :function (params, times, outputs)  </span></span>
<span><span class="co">#&gt;   ..- attr(*, "srcref")= 'srcref' int [1:8] 42 14 51 1 14 1 42 51</span></span>
<span><span class="co">#&gt;   .. ..- attr(*, "srcfile")=Classes 'srcfilecopy', 'srcfile' &lt;environment: 0x00000208eb481c18&gt; </span></span>
<span><span class="co">#&gt;  $ wave0          :List of 5</span></span>
<span><span class="co">#&gt;   ..$ inputs    :'data.frame':   180 obs. of  9 variables:</span></span>
<span><span class="co">#&gt;   .. ..$ b      : num [1:180] 3.10e-05 5.55e-05 5.18e-05 3.06e-05 4.77e-05 ...</span></span>
<span><span class="co">#&gt;   .. ..$ mu     : num [1:180] 6.00e-05 4.45e-05 7.34e-05 3.87e-05 3.02e-05 ...</span></span>
<span><span class="co">#&gt;   .. ..$ beta1  : num [1:180] 0.244 0.25 0.295 0.232 0.278 ...</span></span>
<span><span class="co">#&gt;   .. ..$ beta2  : num [1:180] 0.141 0.161 0.163 0.163 0.135 ...</span></span>
<span><span class="co">#&gt;   .. ..$ beta3  : num [1:180] 0.474 0.421 0.462 0.379 0.388 ...</span></span>
<span><span class="co">#&gt;   .. ..$ epsilon: num [1:180] 0.141 0.136 0.111 0.122 0.132 ...</span></span>
<span><span class="co">#&gt;   .. ..$ alpha  : num [1:180] 0.0202 0.0218 0.0154 0.0153 0.0171 ...</span></span>
<span><span class="co">#&gt;   .. ..$ gamma  : num [1:180] 0.0634 0.0598 0.0664 0.0568 0.0615 ...</span></span>
<span><span class="co">#&gt;   .. ..$ omega  : num [1:180] 0.00308 0.00254 0.00269 0.0032 0.00347 ...</span></span>
<span><span class="co">#&gt;   ..$ results   :'data.frame':   180 obs. of  12 variables:</span></span>
<span><span class="co">#&gt;   .. ..$ I25 : num [1:180] 150 156 153 148 172 ...</span></span>
<span><span class="co">#&gt;   .. ..$ I40 : num [1:180] 190 203 208 209 222 ...</span></span>
<span><span class="co">#&gt;   .. ..$ I100: num [1:180] 27.9 27.8 29.2 46.4 28.1 ...</span></span>
<span><span class="co">#&gt;   .. ..$ I200: num [1:180] 1.131 0.998 1.148 3.555 1.279 ...</span></span>
<span><span class="co">#&gt;   .. ..$ I300: num [1:180] 56.5 15.2 21.1 44.6 36.3 ...</span></span>
<span><span class="co">#&gt;   .. ..$ I350: num [1:180] 44.2 61.3 67.2 59.5 73.9 ...</span></span>
<span><span class="co">#&gt;   .. ..$ R25 : num [1:180] 129 124 129 110 135 ...</span></span>
<span><span class="co">#&gt;   .. ..$ R40 : num [1:180] 287 283 306 258 313 ...</span></span>
<span><span class="co">#&gt;   .. ..$ R100: num [1:180] 591 602 670 626 624 ...</span></span>
<span><span class="co">#&gt;   .. ..$ R200: num [1:180] 466 497 546 514 473 ...</span></span>
<span><span class="co">#&gt;   .. ..$ R300: num [1:180] 405 404 443 437 375 ...</span></span>
<span><span class="co">#&gt;   .. ..$ R350: num [1:180] 549 471 545 538 518 ...</span></span>
<span><span class="co">#&gt;   ..$ data      :'data.frame':   180 obs. of  21 variables:</span></span>
<span><span class="co">#&gt;   .. ..$ b      : num [1:180] 3.10e-05 5.55e-05 5.18e-05 3.06e-05 4.77e-05 ...</span></span>
<span><span class="co">#&gt;   .. ..$ mu     : num [1:180] 6.00e-05 4.45e-05 7.34e-05 3.87e-05 3.02e-05 ...</span></span>
<span><span class="co">#&gt;   .. ..$ beta1  : num [1:180] 0.244 0.25 0.295 0.232 0.278 ...</span></span>
<span><span class="co">#&gt;   .. ..$ beta2  : num [1:180] 0.141 0.161 0.163 0.163 0.135 ...</span></span>
<span><span class="co">#&gt;   .. ..$ beta3  : num [1:180] 0.474 0.421 0.462 0.379 0.388 ...</span></span>
<span><span class="co">#&gt;   .. ..$ epsilon: num [1:180] 0.141 0.136 0.111 0.122 0.132 ...</span></span>
<span><span class="co">#&gt;   .. ..$ alpha  : num [1:180] 0.0202 0.0218 0.0154 0.0153 0.0171 ...</span></span>
<span><span class="co">#&gt;   .. ..$ gamma  : num [1:180] 0.0634 0.0598 0.0664 0.0568 0.0615 ...</span></span>
<span><span class="co">#&gt;   .. ..$ omega  : num [1:180] 0.00308 0.00254 0.00269 0.0032 0.00347 ...</span></span>
<span><span class="co">#&gt;   .. ..$ I25    : num [1:180] 150 156 153 148 172 ...</span></span>
<span><span class="co">#&gt;   .. ..$ I40    : num [1:180] 190 203 208 209 222 ...</span></span>
<span><span class="co">#&gt;   .. ..$ I100   : num [1:180] 27.9 27.8 29.2 46.4 28.1 ...</span></span>
<span><span class="co">#&gt;   .. ..$ I200   : num [1:180] 1.131 0.998 1.148 3.555 1.279 ...</span></span>
<span><span class="co">#&gt;   .. ..$ I300   : num [1:180] 56.5 15.2 21.1 44.6 36.3 ...</span></span>
<span><span class="co">#&gt;   .. ..$ I350   : num [1:180] 44.2 61.3 67.2 59.5 73.9 ...</span></span>
<span><span class="co">#&gt;   .. ..$ R25    : num [1:180] 129 124 129 110 135 ...</span></span>
<span><span class="co">#&gt;   .. ..$ R40    : num [1:180] 287 283 306 258 313 ...</span></span>
<span><span class="co">#&gt;   .. ..$ R100   : num [1:180] 591 602 670 626 624 ...</span></span>
<span><span class="co">#&gt;   .. ..$ R200   : num [1:180] 466 497 546 514 473 ...</span></span>
<span><span class="co">#&gt;   .. ..$ R300   : num [1:180] 405 404 443 437 375 ...</span></span>
<span><span class="co">#&gt;   .. ..$ R350   : num [1:180] 549 471 545 538 518 ...</span></span>
<span><span class="co">#&gt;   ..$ training  :'data.frame':   100 obs. of  21 variables:</span></span>
<span><span class="co">#&gt;   .. ..$ b      : num [1:100] 3.10e-05 5.55e-05 5.18e-05 3.06e-05 4.77e-05 ...</span></span>
<span><span class="co">#&gt;   .. ..$ mu     : num [1:100] 6.00e-05 4.45e-05 7.34e-05 3.87e-05 3.02e-05 ...</span></span>
<span><span class="co">#&gt;   .. ..$ beta1  : num [1:100] 0.244 0.25 0.295 0.232 0.278 ...</span></span>
<span><span class="co">#&gt;   .. ..$ beta2  : num [1:100] 0.141 0.161 0.163 0.163 0.135 ...</span></span>
<span><span class="co">#&gt;   .. ..$ beta3  : num [1:100] 0.474 0.421 0.462 0.379 0.388 ...</span></span>
<span><span class="co">#&gt;   .. ..$ epsilon: num [1:100] 0.141 0.136 0.111 0.122 0.132 ...</span></span>
<span><span class="co">#&gt;   .. ..$ alpha  : num [1:100] 0.0202 0.0218 0.0154 0.0153 0.0171 ...</span></span>
<span><span class="co">#&gt;   .. ..$ gamma  : num [1:100] 0.0634 0.0598 0.0664 0.0568 0.0615 ...</span></span>
<span><span class="co">#&gt;   .. ..$ omega  : num [1:100] 0.00308 0.00254 0.00269 0.0032 0.00347 ...</span></span>
<span><span class="co">#&gt;   .. ..$ I25    : num [1:100] 150 156 153 148 172 ...</span></span>
<span><span class="co">#&gt;   .. ..$ I40    : num [1:100] 190 203 208 209 222 ...</span></span>
<span><span class="co">#&gt;   .. ..$ I100   : num [1:100] 27.9 27.8 29.2 46.4 28.1 ...</span></span>
<span><span class="co">#&gt;   .. ..$ I200   : num [1:100] 1.131 0.998 1.148 3.555 1.279 ...</span></span>
<span><span class="co">#&gt;   .. ..$ I300   : num [1:100] 56.5 15.2 21.1 44.6 36.3 ...</span></span>
<span><span class="co">#&gt;   .. ..$ I350   : num [1:100] 44.2 61.3 67.2 59.5 73.9 ...</span></span>
<span><span class="co">#&gt;   .. ..$ R25    : num [1:100] 129 124 129 110 135 ...</span></span>
<span><span class="co">#&gt;   .. ..$ R40    : num [1:100] 287 283 306 258 313 ...</span></span>
<span><span class="co">#&gt;   .. ..$ R100   : num [1:100] 591 602 670 626 624 ...</span></span>
<span><span class="co">#&gt;   .. ..$ R200   : num [1:100] 466 497 546 514 473 ...</span></span>
<span><span class="co">#&gt;   .. ..$ R300   : num [1:100] 405 404 443 437 375 ...</span></span>
<span><span class="co">#&gt;   .. ..$ R350   : num [1:100] 549 471 545 538 518 ...</span></span>
<span><span class="co">#&gt;   ..$ validation:'data.frame':   80 obs. of  21 variables:</span></span>
<span><span class="co">#&gt;   .. ..$ b      : num [1:80] 8.44e-05 4.63e-05 6.27e-05 2.70e-05 7.02e-05 ...</span></span>
<span><span class="co">#&gt;   .. ..$ mu     : num [1:80] 6.68e-05 7.10e-05 5.96e-05 5.52e-05 2.93e-05 ...</span></span>
<span><span class="co">#&gt;   .. ..$ beta1  : num [1:80] 0.276 0.224 0.221 0.289 0.274 ...</span></span>
<span><span class="co">#&gt;   .. ..$ beta2  : num [1:80] 0.142 0.14 0.168 0.124 0.159 ...</span></span>
<span><span class="co">#&gt;   .. ..$ beta3  : num [1:80] 0.362 0.364 0.378 0.349 0.455 ...</span></span>
<span><span class="co">#&gt;   .. ..$ epsilon: num [1:80] 0.106 0.162 0.12 0.143 0.143 ...</span></span>
<span><span class="co">#&gt;   .. ..$ alpha  : num [1:80] 0.0173 0.016 0.0187 0.0208 0.0192 ...</span></span>
<span><span class="co">#&gt;   .. ..$ gamma  : num [1:80] 0.059 0.0771 0.0629 0.0705 0.0764 ...</span></span>
<span><span class="co">#&gt;   .. ..$ omega  : num [1:80] 0.00308 0.00313 0.00343 0.00305 0.00249 ...</span></span>
<span><span class="co">#&gt;   .. ..$ I25    : num [1:80] 146 132 124 164 149 ...</span></span>
<span><span class="co">#&gt;   .. ..$ I40    : num [1:80] 206 154 169 192 176 ...</span></span>
<span><span class="co">#&gt;   .. ..$ I100   : num [1:80] 39.5 23 44.2 16.6 17.3 ...</span></span>
<span><span class="co">#&gt;   .. ..$ I200   : num [1:80] 1.904 0.885 3.564 0.279 0.387 ...</span></span>
<span><span class="co">#&gt;   .. ..$ I300   : num [1:80] 18.79 19.27 43.32 2.75 8.22 ...</span></span>
<span><span class="co">#&gt;   .. ..$ I350   : num [1:80] 67 75.1 53.5 31.4 65.4 ...</span></span>
<span><span class="co">#&gt;   .. ..$ R25    : num [1:80] 109 151 108 154 156 ...</span></span>
<span><span class="co">#&gt;   .. ..$ R40    : num [1:80] 261 311 240 340 341 ...</span></span>
<span><span class="co">#&gt;   .. ..$ R100   : num [1:80] 620 599 584 609 643 ...</span></span>
<span><span class="co">#&gt;   .. ..$ R200   : num [1:80] 501 470 477 465 523 ...</span></span>
<span><span class="co">#&gt;   .. ..$ R300   : num [1:80] 394 370 408 345 418 ...</span></span>
<span><span class="co">#&gt;   .. ..$ R350   : num [1:80] 459 506 513 336 491 ...</span></span></code></pre></div>
<p>Run first wave.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sir_hmer</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/run_wave.html">run_wave</a></span><span class="op">(</span><span class="va">sir_hmer</span><span class="op">)</span></span>
<span><span class="co">#&gt; I25 </span></span>
<span><span class="co">#&gt; I40 </span></span>
<span><span class="co">#&gt; I100 </span></span>
<span><span class="co">#&gt; I200 </span></span>
<span><span class="co">#&gt; I300 </span></span>
<span><span class="co">#&gt; I350 </span></span>
<span><span class="co">#&gt; R25 </span></span>
<span><span class="co">#&gt; R40 </span></span>
<span><span class="co">#&gt; R100 </span></span>
<span><span class="co">#&gt; R200 </span></span>
<span><span class="co">#&gt; R300 </span></span>
<span><span class="co">#&gt; R350 </span></span>
<span><span class="co">#&gt; I25 </span></span>
<span><span class="co">#&gt; I40 </span></span>
<span><span class="co">#&gt; I100 </span></span>
<span><span class="co">#&gt; I200 </span></span>
<span><span class="co">#&gt; I300 </span></span>
<span><span class="co">#&gt; I350 </span></span>
<span><span class="co">#&gt; R25 </span></span>
<span><span class="co">#&gt; R40 </span></span>
<span><span class="co">#&gt; R100 </span></span>
<span><span class="co">#&gt; R200 </span></span>
<span><span class="co">#&gt; R300 </span></span>
<span><span class="co">#&gt; R350</span></span>
<span><span class="co"># sir_hmer@run_wave</span></span></code></pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Nathan Green.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
